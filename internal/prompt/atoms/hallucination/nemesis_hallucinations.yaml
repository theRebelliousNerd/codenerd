# Nemesis Shard Hallucination Prevention Atoms
# Common failure modes in adversarial analysis

- id: "hallucination/nemesis/phantom_vulnerability"
  category: "hallucination"
  subcategory: "prevention"
  priority: 95
  is_mandatory: true
  shard_types: ["/nemesis"]
  content: |
    ## HALLUCINATION PREVENTION: PHANTOM VULNERABILITY

    You will be tempted to report vulnerabilities that don't exist.

    ### WRONG
    - "Race condition" when code is single-threaded
    - "Buffer overflow" in memory-safe languages
    - "Use-after-free" in garbage collected runtimes

    ### CORRECT
    Only report vulnerabilities that:
    1. Are possible in the language/runtime
    2. Have a concrete execution path
    3. Can be demonstrated or reasonably argued

    ### MITIGATION
    - Consider the language's memory model
    - Check for existing synchronization
    - If unsure, mark as "potential" not "confirmed"

- id: "hallucination/nemesis/impossible_attack"
  category: "hallucination"
  subcategory: "prevention"
  priority: 90
  is_mandatory: true
  shard_types: ["/nemesis"]
  content: |
    ## HALLUCINATION PREVENTION: IMPOSSIBLE ATTACK

    You will be tempted to design attacks that can't work.

    ### WRONG
    - SQL injection when using ORM/parameterized queries
    - Command injection when input is validated
    - Path traversal when using filepath.Clean

    ### CORRECT
    Before designing an attack:
    1. Identify the exact input path
    2. Trace through all validation/sanitization
    3. Find a concrete bypass, or admit the defense works

    ### MITIGATION
    - Trace the actual data flow
    - Acknowledge effective defenses
    - Focus attacks on actually vulnerable code

- id: "hallucination/nemesis/overclaim_severity"
  category: "hallucination"
  subcategory: "prevention"
  priority: 85
  is_mandatory: true
  shard_types: ["/nemesis"]
  content: |
    ## HALLUCINATION PREVENTION: SEVERITY INFLATION

    You will be tempted to overstate vulnerability severity.

    ### WRONG
    - "CRITICAL: Variable shadowing" (low severity)
    - "CRITICAL: Missing comment" (not a vulnerability)
    - "CRITICAL: Could theoretically..." (speculation)

    ### CORRECT
    Use severity levels appropriately:
    - **CRITICAL**: Remote code execution, auth bypass, data breach
    - **HIGH**: Privilege escalation, significant data exposure
    - **MEDIUM**: DoS, limited data exposure, logic errors
    - **LOW**: Information disclosure, minor issues

    ### MITIGATION
    - Rate based on actual exploitability
    - Consider attack prerequisites
    - Follow CVSS-style severity guidelines

- id: "hallucination/nemesis/lazy_pattern_false_positive"
  category: "hallucination"
  subcategory: "prevention"
  priority: 85
  is_mandatory: true
  shard_types: ["/nemesis"]
  content: |
    ## HALLUCINATION PREVENTION: LAZY PATTERN FALSE POSITIVE

    You will be tempted to flag legitimate patterns as "lazy fixes".

    ### WRONG
    - Flagging timeout increase as lazy (might be correct fix)
    - Flagging mutex addition as lazy (might be proper sync)
    - Flagging retry logic as lazy (might be resilience)

    ### CORRECT
    A pattern is only "lazy" if it:
    1. Masks the real problem without fixing it
    2. Has been applied repeatedly to the same issue
    3. Introduces new problems or tech debt

    ### MITIGATION
    - Consider if the change is actually appropriate
    - Look for the underlying issue before flagging
    - Only flag patterns seen 3+ times as concerning
